import {describe, it, expect} from "vitest";
import ObjectManager from "../../src/ObjectManager";

describe("ObjectManager - copy", () => {
    it("should copy supplied object", () => {
        const obj = {
            user: {
                firstName: "John",
                lastName: "Doe",
                roles: ["super", "admin", "user"],
                children: [
                    {
                        firstName: "Foo",
                        lastName: "Bar",
                        roles: ["user"],
                    },
                ],
            },
        };
        const manager = ObjectManager.on({});

        manager.copy(obj);

        expect(obj).toEqual(manager.get());
        expect(obj).not.toBe(manager.clone());

        expect(obj.user).toEqual(manager.get().user);
        expect(obj.user).not.toBe(manager.clone().user);

        expect(obj.user.roles).toEqual(manager.get().user.roles);
        expect(obj.user.roles).not.toBe(manager.clone().user.roles);

        expect(obj.user.children).toEqual(manager.get().user.children);
        expect(obj.user.children).not.toBe(manager.clone().user.children);

        expect(obj.user.children[0]).toEqual(manager.get().user.children[0]);
        expect(obj.user.children[0]).not.toBe(manager.clone().user.children[0]);

        expect(obj.user.children[0]?.roles).toEqual(manager.get().user.children[0].roles);
        expect(obj.user.children[0]?.roles).not.toBe(manager.clone().user.children[0].roles);
    });
});
